<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>B√© luy·ªán b·∫£ng c·ª≠u ch∆∞∆°ng</title>
  <style>
    :root{
      --bg:#f7fbff;
      --card:#ffffff;
      --accent:#4f46e5;
      --success:#16a34a;
      --danger:#ef4444;
      --muted:#6b7280;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;
      background:linear-gradient(180deg,var(--bg),#eaf2ff);
      display:flex; align-items:center; justify-content:center; min-height:100vh; padding:24px;
    }
    .card{
      width:100%; max-width:720px; background:var(--card); border-radius:20px; box-shadow:0 8px 30px rgba(15,23,42,0.08);
      padding:32px; text-align:center; position:relative;
    }
    h1{margin:0 0 12px; font-size:28px; line-height:1.3}
    p.lead{margin:0 0 22px; color:var(--muted); font-size:16px; line-height:1.5}
    .question{
      font-size:56px; font-weight:700; margin:20px 0; display:flex; align-items:center; justify-content:center; gap:14px;
    }
    .box{
      background:#f3f4f6; padding:20px 24px; border-radius:14px; display:inline-flex; align-items:center; gap:14px; flex-wrap:wrap; justify-content:center;
    }
    .operator{font-size:28px; opacity:0.8}
    input[type=number]{
      font-size:32px; padding:14px 16px; border-radius:12px; border:2px solid transparent; width:180px; text-align:center;
      outline:none; background:white; box-shadow:0 2px 6px rgba(2,6,23,0.06);
    }
    input[type=number]:focus{border-color:rgba(79,70,229,0.25)}
    .submit-btn{
      font-size:24px; padding:14px 20px; border-radius:12px; border:none; background:var(--accent); color:white;
      font-weight:700; cursor:pointer; box-shadow:0 4px 12px rgba(79,70,229,0.3); transition:all 0.2s;
      min-width:100px;
    }
    .submit-btn:hover{background:#4338ca; transform:translateY(-2px); box-shadow:0 6px 16px rgba(79,70,229,0.4)}
    .submit-btn:active{transform:translateY(0); box-shadow:0 2px 8px rgba(79,70,229,0.3)}
    .status{min-height:60px; margin-top:20px}
    .status .ok{color:var(--success); font-weight:800; font-size:34px; display:inline-block; animation:pop 800ms ease forwards, glow 1.2s ease-in-out infinite alternate}
    .status .err{color:var(--danger); font-weight:700; font-size:28px; display:inline-block; animation:shake 480ms ease}
    .status .correct-answer{display:block; margin-top:8px; font-size:20px; color:var(--muted)}
    .stats{margin-top:24px; display:flex; justify-content:center; gap:32px; font-size:20px; font-weight:600}
    .stats span{padding:10px 18px; border-radius:12px; box-shadow:0 4px 12px rgba(2,6,23,0.08)}
    .stats .correct{background:#ecfdf5; color:var(--success)}
    .stats .wrong{background:#fef2f2; color:var(--danger)}
    .history{margin-top:28px; text-align:left; max-height:260px; overflow-y:auto; border-top:1px solid #e5e7eb; padding-top:16px}
    .history h2{font-size:18px; margin:0 0 10px; color:var(--muted)}
    .history ul{list-style:none; margin:0; padding:0; font-size:18px}
    .history li{margin:6px 0; padding:6px 10px; border-radius:8px}
    .history li.correct{background:#ecfdf5; color:var(--success); font-weight:600}
    .history li.wrong{background:#fef2f2; color:var(--danger); font-weight:600}
    .small{font-size:14px; color:var(--muted)}
    .settings{display:flex; gap:10px; justify-content:center; margin-top:20px; align-items:center; flex-wrap:wrap}
    select{padding:8px 10px; border-radius:8px; border:1px solid #e6e9ef}
    .number-buttons{display:flex; gap:8px; margin-top:16px; justify-content:center; flex-wrap:wrap}
    .num-btn{padding:12px 18px; border-radius:10px; border:2px solid #e5e7eb; background:white; font-size:18px; font-weight:600; cursor:pointer; transition:all 0.2s}
    .num-btn:hover{background:#f3f4f6; transform:translateY(-2px)}
    .num-btn.active{background:var(--accent); color:white; border-color:var(--accent)}
    @media (max-width:520px){
      body{padding:12px}
      .card{padding:20px; border-radius:16px}
      h1{font-size:22px; margin-bottom:8px}
      p.lead{font-size:14px; margin-bottom:16px}
      .question{font-size:32px; margin:16px 0; gap:8px; flex-wrap:wrap}
      .box{padding:14px 16px; gap:8px; flex-wrap:wrap; justify-content:center}
      .operator{font-size:20px}
      input[type=number]{width:110px; font-size:22px; padding:10px 12px}
      .submit-btn{font-size:20px; padding:10px 16px; min-width:80px}
      .status{min-height:50px; margin-top:16px}
      .status .ok{font-size:24px}
      .status .err{font-size:20px}
      .status .correct-answer{font-size:16px; margin-top:6px}
      .stats{margin-top:20px; gap:16px; font-size:16px}
      .stats span{padding:8px 14px}
      .settings{margin-top:16px; gap:8px}
      .number-buttons{gap:6px; margin-top:12px}
      .num-btn{padding:10px 14px; font-size:16px}
      .history{margin-top:20px; max-height:200px; padding-top:12px}
      .history h2{font-size:16px; margin-bottom:8px}
      .history ul{font-size:15px}
      .history li{margin:4px 0; padding:5px 8px; font-size:14px}
      .small{font-size:12px}
    }
    @media (max-width:380px){
      body{padding:8px}
      .card{padding:16px}
      h1{font-size:20px}
      p.lead{font-size:13px}
      .question{font-size:28px}
      input[type=number]{width:100px; font-size:20px}
      .submit-btn{font-size:18px; padding:8px 14px; min-width:70px}
      .num-btn{padding:8px 12px; font-size:15px}
    }
    @keyframes shake{0%{transform:translateX(0)}25%{transform:translateX(-6px)}50%{transform:translateX(6px)}75%{transform:translateX(-4px)}100%{transform:translateX(0)}}
    @keyframes pop{0%{transform:scale(0.5);opacity:0}60%{transform:scale(1.3);opacity:1}100%{transform:scale(1)}}
    @keyframes glow{from{text-shadow:0 0 8px rgba(22,163,74,0.5),0 0 20px rgba(22,163,74,0.3)} to{text-shadow:0 0 16px rgba(22,163,74,0.9),0 0 30px rgba(22,163,74,0.5)}}
    .confetti{position:absolute; width:8px; height:8px; background:var(--accent); top:0; left:0; opacity:0.9; border-radius:2px; animation:fall 3s linear forwards}
    @keyframes fall{0%{transform:translateY(0) rotate(0)}100%{transform:translateY(600px) rotate(360deg);opacity:0}}
  </style>
</head>
<body>
  <div class="card" role="main">
    <h1>B√© luy·ªán b·∫£ng c·ª≠u ch∆∞∆°ng</h1>
    <p class="lead">Nh·∫•n v√†o n√∫t s·ªë (2-9) ƒë·ªÉ luy·ªán t·∫≠p ch·ªâ v·ªõi s·ªë ƒë√≥. Nh·∫•n l·∫°i ƒë·ªÉ t·∫Øt ch·∫ø ƒë·ªô luy·ªán t·∫≠p.</p>

    <div class="number-buttons">
      <button class="num-btn" data-num="2">2</button>
      <button class="num-btn" data-num="3">3</button>
      <button class="num-btn" data-num="4">4</button>
      <button class="num-btn" data-num="5">5</button>
      <button class="num-btn" data-num="6">6</button>
      <button class="num-btn" data-num="7">7</button>
      <button class="num-btn" data-num="8">8</button>
      <button class="num-btn" data-num="9">9</button>
    </div>

    <div class="stats">
      <span class="correct">ƒê√∫ng: <span id="correctCount">0</span></span>
      <span class="wrong">Sai: <span id="wrongCount">0</span></span>
    </div>

    <div class="status" aria-live="assertive"><span id="message"></span></div>

    <div class="question" aria-live="polite">
      <div class="box">
        <span id="a">6</span>
        <span class="operator">√ó</span>
        <span id="b">7</span>
        <span class="operator">=</span>
        <input id="answer" type="number" inputmode="numeric" autocomplete="off" aria-label="Nh·∫≠p ƒë√°p √°n">
        <button id="submitBtn" class="submit-btn">OK</button>
      </div>
    </div>

    <div class="history">
      <h2>L·ªãch s·ª≠ l√†m b√†i</h2>
      <ul id="historyList"></ul>
    </div>

    <p class="small" style="margin-top:18px">B√© nh·∫≠p k·∫øt qu·∫£ v√† nh·∫•n Enter ho·∫∑c n√∫t OK. N·∫øu ƒë√∫ng, hi·ªán "Ch√≠nh x√°c!", r·ªìi nh·∫•n Enter/OK l·∫ßn n·ªØa ƒë·ªÉ sang c√¢u m·ªõi.</p>
  </div>

  <script>
    (function(){
      const aEl = document.getElementById('a');
      const bEl = document.getElementById('b');
      const answerEl = document.getElementById('answer');
      const msgEl = document.getElementById('message');
      const correctEl = document.getElementById('correctCount');
      const wrongEl = document.getElementById('wrongCount');
      const historyList = document.getElementById('historyList');
      const submitBtn = document.getElementById('submitBtn');

      let current = {a:6,b:7};
      let awaitingNext = false;
      let correctCount = 0;
      let wrongCount = 0;
      let focusedNumber = null;

      function randInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min }

      function newQuestion(){
        const range = {min: 1, max: 9};

        if(focusedNumber !== null){
          // One operand is the focused number, the other is random
          if(Math.random() < 0.5){
            current.a = focusedNumber;
            current.b = randInt(range.min, range.max);
          } else {
            current.a = randInt(range.min, range.max);
            current.b = focusedNumber;
          }
        } else {
          // Normal mode: both operands are random
          current.a = randInt(range.min, range.max);
          current.b = randInt(range.min, range.max);
        }

        aEl.textContent = current.a;
        bEl.textContent = current.b;
        msgEl.textContent = '';
        answerEl.value = '';
        answerEl.classList.remove('shake');
        answerEl.focus();
        awaitingNext = false;
        submitBtn.textContent = 'OK';
      }

      function throwConfetti(){
        for(let i=0;i<20;i++){
          const conf = document.createElement('div');
          conf.className = 'confetti';
          conf.style.left = Math.random()*100+'%';
          conf.style.background = `hsl(${Math.random()*360},80%,60%)`;
          conf.style.animationDuration = (2+Math.random()*2)+'s';
          document.body.appendChild(conf);
          setTimeout(()=>conf.remove(),3000);
        }
      }

      function addHistory(expr,result,correct,correctAnswer){
        const li = document.createElement('li');
        if(correct){
          li.textContent = expr + ' = ' + result + ' ‚úîÔ∏è';
          li.className = 'correct';
        } else {
          li.textContent = expr + ' ‚â† ' + result + ' ‚ùå (ƒê√∫ng: ' + correctAnswer + ')';
          li.className = 'wrong';
        }
        historyList.insertBefore(li, historyList.firstChild);
      }

      function checkAnswer(){
        if(awaitingNext){
          newQuestion();
          return;
        }
        const val = answerEl.value.trim();
        if(val === ''){ msgEl.textContent = 'B·∫°n ch∆∞a nh·∫≠p ƒë√°p √°n.'; return }
        const num = Number(val);
        const correct = current.a * current.b;
        if(Number.isNaN(num)){
          msgEl.textContent = 'Vui l√≤ng nh·∫≠p s·ªë h·ª£p l·ªá.';
          answerEl.value = '';
          answerEl.focus();
          return;
        }
        if(num === correct){
          correctCount++;
          correctEl.textContent = correctCount;
          msgEl.innerHTML = '<span class="ok">Ch√≠nh x√°c! üéâ</span>';
          throwConfetti();
          addHistory(`${current.a} √ó ${current.b}`, num, true, correct);
          awaitingNext = true;
          submitBtn.textContent = 'Next';
        } else {
          wrongCount++;
          wrongEl.textContent = wrongCount;
          msgEl.innerHTML = '<span class="err">Sai r·ªìi ‚Äî th·ª≠ l·∫°i nh√©.</span>' + `<span class="correct-answer">ƒê√°p √°n ƒë√∫ng: ${correct}</span>`;
          addHistory(`${current.a} √ó ${current.b}`, num, false, correct);
          answerEl.value = '';
          void answerEl.offsetWidth;
          answerEl.classList.add('shake');
          answerEl.focus();
        }
      }

      answerEl.addEventListener('keydown', function(e){
        if(e.key === 'Enter'){
          e.preventDefault(); checkAnswer();
        }
      });

      // Submit button handler
      submitBtn.addEventListener('click', function(){
        checkAnswer();
      });

      // Number button handlers
      const numButtons = document.querySelectorAll('.num-btn');
      numButtons.forEach(btn => {
        btn.addEventListener('click', function(){
          const num = parseInt(this.dataset.num);

          // Toggle: if clicking the same button, deactivate
          if(focusedNumber === num){
            focusedNumber = null;
            this.classList.remove('active');
          } else {
            // Remove active class from all buttons
            numButtons.forEach(b => b.classList.remove('active'));
            // Set new focused number
            focusedNumber = num;
            this.classList.add('active');
          }

          newQuestion();
        });
      });

      newQuestion();
    })();
  </script>
</body>
</html>